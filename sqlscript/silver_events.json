{
	"name": "silver_events",
	"properties": {
		"content": {
			"query": "WITH fileData AS(\n    SELECT  \n    -- result.filepath() AS file_path,\n    TRY_CAST(SUBSTRING(result.filepath(), CHARINDEX('year=', result.filepath()) + 5, 4) AS INT) AS year, -- position after 'year=' since year= length is 5 and length of year is 4\n    TRY_CAST(SUBSTRING(result.filepath(), CHARINDEX('month=', result.filepath()) + 6, 2) AS INT) AS month,\n    TRY_CAST(SUBSTRING(result.filepath(), CHARINDEX('day=', result.filepath()) + 4, 2) AS INT) AS day\nFROM\n    OPENROWSET(\n        BULK 'https://stdimentoringdatalakecm.dfs.core.windows.net/data/silver/events/year=*/month=*/day=*/*.parquet',\n        FORMAT = 'PARQUET'\n    ) WITH (\n        year int,\n        month int,\n        day int\n    ) AS [result]\n)\nSELECT\n    year,\n    month,\n    day,\n    COUNT(*) AS row_count\nFROM fileData\nGROUP BY  \n    year,\n    month,\n    day\nORDER BY\n    year,\n    month,\n    day;\n\n\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "master",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}